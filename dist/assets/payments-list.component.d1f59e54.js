import{h as m,_ as u,E as y,C as g,r as c,o as _,c as f,a as s,b as o,w as l,p as S,e as v,t as i,j as w}from"./index.06d337ed.js";class b{getAll(){return m.get("/payments")}getById(t){return m.get(`/payments/${t}`)}findPaymentByShipmentId(t){return m.get(`/payments/shipment/${t}`)}}const x={name:"payments-list",data(){return{payments:[],payment:{},expandedRowGroups:null,filters:{},paymentsService:null,enterpriseShipmentService:null,customerShipmentService:null,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],contact:""}},created(){console.log(this.$dataTransfer.enterpriseShipmentsIds),console.log(this.$dataTransfer.customerShipmentsIds),this.paymentsService=new b,this.enterpriseShipmentService=new y,this.customerShipmentService=new g,this.getPaymentsByShipmentsId()},props:{isCustomer:Boolean},methods:{getLongMonthName(e){return this.monthNames[e.getMonth()]+"-"+e.getFullYear()},getDisplayablePayment(e){return e.paymentMonthYearDate=this.getLongMonthName(new Date(e.paymentDate)),e.dateShort=e.paymentDate.substring(0,7),e},getPaymentsByShipmentsId(){if(this.isCustomer){this.$dataTransfer.customerShipmentsIds.forEach(e=>{this.paymentsService.findPaymentByShipmentId(e).then(t=>{this.payments.push(t.data),console.log(this.payments),this.payments.forEach(a=>{this.getDisplayablePayment(a)})})});return}this.$dataTransfer.enterpriseShipmentsIds.forEach(e=>{this.paymentsService.findPaymentByShipmentId(e).then(t=>{this.payments.push(t.data),this.payments.forEach(a=>{this.getDisplayablePayment(a)})})})},onRowGroupExpand(e){this.$toast.add({severity:"info",summary:"Row Group Expanded",detail:"Value: "+e.data,life:3e3})},onRowGroupCollapse(e){this.$toast.add({severity:"success",summary:"Row Group Collapsed",detail:"Value: "+e.data,life:3e3})},calculatePaymentTotalAmount(e){let t=0;if(this.payments)for(let a of this.payments)a.paymentMonthYearDate===e&&(t=t+a.amount);return t},calculatePaymentTotal(e){let t=0;if(this.payments)for(let a of this.payments)a.paymentMonthYearDate===e&&t++;return t},formatCurrency(e){return"S/. "+e}}},D=e=>(S("data-v-5e98188c"),e=e(),v(),e),I={class:"card"},C=D(()=>s("h1",null,"Payments received",-1)),M={class:"card-container"},P={class:"group-header"},R={class:"group-header-container"},E={class:"group-header-container-item"},B={class:"group-header-container-item"},G={class:"group-header-container-item"};function T(e,t,a,Y,d,r){const p=c("pv-column"),h=c("pv-data-table");return _(),f("div",I,[C,s("div",M,[o(h,{value:d.payments,"row-group-mode":"subheader","group-rows-by":"paymentMonthYearDate","sort-mode":"single","sort-field":"dateShort","sort-order":-1,"expandable-row-groups":!0,"expanded-row-icon":"pi-eye-slash","collapsed-row-icon":"pi-eye","expanded-row-groups":d.expandedRowGroups,"onUpdate:expanded-row-groups":t[0]||(t[0]=n=>d.expandedRowGroups=n),onRowgroupExpand:r.onRowGroupExpand,onRowgroupCollapse:r.onRowGroupCollapse},{groupheader:l(n=>[s("div",P,[s("div",R,[s("td",E,i(n.data.paymentMonthYearDate),1),s("td",B,i(r.calculatePaymentTotal(n.data.paymentMonthYearDate))+" payments ",1),s("td",G," S/. "+i(r.calculatePaymentTotalAmount(n.data.paymentMonthYearDate)),1)])])]),default:l(()=>[o(p,{field:"paymentMonthYearDate",header:"Date"}),o(p,{field:"shipmentId",header:"Code Shipping",class:"bg-gray-200 border-primary hover:bg-gray-500"}),o(p,{field:"paymentDate",header:"Payment Date",class:"bg-gray-200 border-primary"}),o(p,{field:"amount",header:"Amount",class:"bg-gray-200 border-primary"},{body:l(n=>[w(i(r.formatCurrency(n.data.amount)),1)]),_:1})]),_:1},8,["value","expanded-row-groups","onRowgroupExpand","onRowgroupCollapse"])])])}var N=u(x,[["render",T],["__scopeId","data-v-5e98188c"]]);export{N as default};
