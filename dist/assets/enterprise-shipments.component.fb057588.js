var V=Object.defineProperty;var C=Object.getOwnPropertySymbols;var A=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var k=(s,e,a)=>e in s?V(s,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[e]=a,w=(s,e)=>{for(var a in e||(e={}))A.call(e,a)&&k(s,a,e[a]);if(C)for(var a of C(e))B.call(e,a)&&k(s,a,e[a]);return s};import{_ as E,F as p,E as F,r as d,o,c,b as n,w as l,f as T,g as M,i as f,a as r,n as x,t as g,j as I}from"./index.06d337ed.js";const O={name:"enterprise-shipments-list",data(){return{enterpriseShipmentsService:null,shipments:[],columns:[{field:"id",header:"Code"},{field:"origin",header:"Origin"},{field:"pickUpDate",header:"Pick Up Date"},{field:"destiny",header:"Destiny"},{field:"deliveryDate",header:"Delivery Date"},{field:"status",header:"Status"}],currentShipments:[],dialogEnabled:!1,statusEnabled:!1,statusses:[{label:"Pending",value:"Pending"},{label:"Finished",value:"Finished"},{label:"In progress",value:"In progress"}],selectedStatus:null,shipment:{},submitted:!1,tableIsLoading:!0,statuses:["Pending","In progress","Finished"],filters:{global:{value:null,matchMode:p.CONTAINS},id:{value:null,matchMode:p.EQUALS},origin:{value:null,matchMode:p.CONTAINS},pickUpDate:{value:null,matchMode:p.DATE_IS},destiny:{value:null,matchMode:p.CONTAINS},deliveryDate:{value:null,matchMode:p.CONTAINS},status:{value:null,matchMode:p.EQUALS}}}},created(){this.enterpriseShipmentsService=new F,this.enterpriseShipmentsService.getShipmentsById(this.id).then(s=>{this.shipments=s.data,this.currentShipments=this.shipments,this.shipments.forEach(e=>{this.$dataTransfer.addEnterpriseShipmentId(e.id)}),this.tableIsLoading=!1})},props:{id:Number},methods:{filterContent(s){if(s==="All"){this.currentShipments=this.shipments;return}this.currentShipments=this.shipments.filter(e=>e.status===s)},showDialog(){this.dialogEnabled=!this.dialogEnabled},showStatus(){this.statusEnabled=!this.statusEnabled},hideStatusDialog(){this.statusEnabled=!1,this.submitted=!1},findIndexById(s){return this.shipments.findIndex(e=>e.id===s)},saveShipment(){this.submitted=!0,this.shipment.id&&(this.shipment.status=this.shipment.status.value?this.shipment.status.value:this.shipment.status,this.enterpriseShipmentsService.updateShipment(this.shipment.id,this.shipment).then(s=>{this.shipments[this.findIndexById(s.data.id)]=this.shipment})),this.statusEnabled=!1,this.shipment={},window.location.reload()},editStatus(s){console.log(s),this.shipment=w({},s),console.log(this.shipment),this.statusEnabled=!this.statusEnabled}}},j={class:"my-7 flex flex-column"},z=I("No shipments found"),Q=I("Loading customer shipments. Please wait"),$=r("h3",null,"Change actual state",-1),K={class:"field"},q={key:0},G={key:1},H={key:2},J=r("h3",null,"Current Location",-1),R=r("img",{src:"https://www.esedeerre.com/wp-content/uploads/2012/06/geolocalizacion-google-maps.jpg"},null,-1);function W(s,e,a,D,i,h){const _=d("pv-dropdown"),U=d("pv-input-text"),S=d("pv-column"),u=d("pv-button"),L=d("router-link"),N=d("pv-data-table"),b=d("pv-dialog");return o(),c("div",j,[n(N,{filters:i.filters,"onUpdate:filters":e[0]||(e[0]=t=>i.filters=t),value:s.currentCustomerShipments,responsiveLayout:"stack",dataKey:"id",paginator:!0,rows:10,loading:i.tableIsLoading,filterDisplay:"menu"},{empty:l(()=>[z]),loading:l(()=>[Q]),default:l(()=>[(o(!0),c(T,null,M(i.columns,t=>(o(),f(S,{field:t.field,header:t.header,key:t.field},{filter:l(({filterModel:m,filterCallback:y})=>[t.field==="status"?(o(),f(_,{key:0,modelValue:m.value,"onUpdate:modelValue":v=>m.value=v,onChange:v=>y(),options:i.statuses,placeholder:"Any",class:"p-column-filter",style:{"min-width":"14rem"},maxSelectedLabels:1},null,8,["modelValue","onUpdate:modelValue","onChange","options"])):(o(),f(U,{key:1,type:"text",modelValue:m.value,"onUpdate:modelValue":v=>m.value=v,onInput:v=>y(),class:"p-column-filter",placeholder:`Search by name - ${m.matchMode}`},null,8,["modelValue","onUpdate:modelValue","onInput","placeholder"]))]),_:2},1032,["field","header"]))),128)),n(S,{exportable:!1,style:{"min-width":"8rem"}},{body:l(t=>[n(u,{icon:"pi pi-car",class:"p-button-text p-button-rounded"}),n(u,{icon:"pi pi-pencil",class:"p-button-text p-button-rounded",onClick:m=>h.editStatus(t.data)},null,8,["onClick"]),n(L,{to:`/enterprise/${this.id}/shipments/${t.data.id}/shipment-detail`},{default:l(()=>[n(u,{icon:"pi pi-eye",class:"p-button-text p-button-rounded"})]),_:2},1032,["to"])]),_:1})]),_:1},8,["filters","value","loading"]),n(b,{visible:i.statusEnabled,"onUpdate:visible":e[1]||(e[1]=t=>i.statusEnabled=t)},{header:l(()=>[$]),footer:l(()=>[n(u,{label:"Submit",autofocus:"",onClick:h.showStatus},null,8,["onClick"])]),_:1},8,["visible"]),n(b,{visible:i.statusEnabled,"onUpdate:visible":e[3]||(e[3]=t=>i.statusEnabled=t),style:{widht:"450px"},header:"Status information",modal:!0,class:"p-fluid"},{footer:l(()=>[n(u,{label:"Cancel".toUpperCase(),icon:"pi pi-times",class:"p-button-text",onClick:h.hideStatusDialog},null,8,["label","onClick"]),n(u,{label:"Save".toUpperCase(),icon:"pi pi-check",class:"p-button-text",onClick:h.saveShipment},null,8,["label","onClick"])]),default:l(()=>[r("div",K,[n(_,{id:"status",modelValue:i.shipment.status,"onUpdate:modelValue":e[2]||(e[2]=t=>i.shipment.status=t),options:i.statusses,optionLabel:"label",placeholder:"Select a new status"},{value:l(t=>[t.value&&t.value.value?(o(),c("div",q,[r("span",{class:x("shipment-badge status-"+t.value.value)},g(t.value.label),3)])):t.value&&!t.value.value?(o(),c("div",G,[r("span",{class:x("shipment-badge status-"+t.value.toLowerCase())},g(t.value),3)])):(o(),c("span",H,g(t.placeholder),1))]),_:1},8,["modelValue","options"])])]),_:1},8,["visible"]),n(b,{visible:i.dialogEnabled,"onUpdate:visible":e[4]||(e[4]=t=>i.dialogEnabled=t)},{header:l(()=>[J]),footer:l(()=>[n(u,{label:"Ok",autofocus:"",onClick:h.showDialog},null,8,["onClick"])]),default:l(()=>[R]),_:1},8,["visible"])])}var X=E(O,[["render",W]]);const Y={name:"shipments-component",components:{EnterpriseShipmentsList:X},methods:{filterData(){this.$refs.enterpriseShipmentList.filterContent(this.$refs.enterpriseShipmentFilter.selectedItem)}},props:{id:Number}},Z={class:"container"},P={class:"flex flex-column space-between align-items-center",style:{"max-width":"45rem",width:"100%",margin:"0 auto","min-height":"90vh"}};function ee(s,e,a,D,i,h){const _=d("enterprise-shipments-list");return o(),c("div",Z,[r("div",P,[n(_,{ref:"enterpriseShipmentList",id:this.id},null,8,["id"])])])}var ie=E(Y,[["render",ee]]);export{ie as default};
