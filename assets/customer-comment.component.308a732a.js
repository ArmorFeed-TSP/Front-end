import{C as f}from"./comments-api.service.565d5dea.js";import{_ as v,C,F as g,r as n,o as d,c as h,a as o,b as i,w as a,n as I,d as S,p as b,e as x}from"./index.06d337ed.js";const y={name:"customer-comments",data(){return{comments:[],commentDialog:!1,deleteCommentDialog:!1,deleteCommentsDialog:!1,comment:{},filters:{},submitted:!1,commentsService:null,selectedComments:null,sizeComments:0,displayBoxComment:!0,userId:null,shipmentId:null,enterprise:{},customerShipmentsApiService:null,customerShipment:{}}},created(){this.getCustomerId(),this.getEnterpriseId(),this.commentsService=new f,this.commentsService.getAll().then(e=>{this.comments=e.data,this.comments.forEach(t=>this.getDisplayableComment(t)),this.sizeComments=this.comments.length,console.log(this.sizeComments,"size"),this.sizeComments===0&&(this.displayBoxComment=!1)}),this.initFilters()},mounted(){this.shipmentId=this.$route.params.id2},methods:{getDisplayableComment(e){return e.id=this.comment.id,e},getStorableComment(e){return{id:e.id,title:e.title,content:e.content,shipmentId:e.shipmentId,customerId:e.customerId}},getEnterpriseId(){this.shipmentId=this.$route.params.id2,this.customerShipmentsApiService=new C,this.customerShipmentsApiService.getShipmentById(this.shipmentId).then(e=>{this.customerShipment=e.data,this.customerShipmentsApiService.getEnterpriseById(this.customerShipment.enterpriseId).then(t=>{this.enterprise=t.data})})},getCustomerId(){const e=JSON.parse(localStorage.getItem("auth"));e&&(this.userId=e.id)},openNew(){this.comment={},this.submitted=!1,this.commentDialog=!0},hideDialog(){this.commentDialog=!1,this.submitted=!1},findIndexById(e){return this.comments.findIndex(t=>t.id===e)},saveComment(){this.submitted=!0,this.comment.title.trim()&&(this.comment.id?(this.comment=this.getStorableComment(this.comment),this.commentsService.update(this.comment.id,this.comment).then(e=>{this.comments[this.findIndexById(e.data.id)]=this.getDisplayableComment(e.data),this.$toast.add({severity:"success",summary:"Successful",detail:"comment Updated",life:3e3}),console.log(e)})):(this.comment.id=0,this.comment.shipmentId=this.shipmentId,this.comment.customerId=this.userId,console.log(this.comment),this.commentsService.create(this.comment).then(e=>{this.comment=this.getDisplayableComment(e.data),this.comments.push(this.comment),this.$toast.add({severity:"success",summary:"Successful",detail:"comment Created",life:3e3}),console.log(e)})),this.commentDialog=!1,this.comment={})},initFilters(){this.filters={global:{value:null,matchMode:g.CONTAINS}}}}},p=e=>(b("data-v-1895551c"),e=e(),x(),e),D={class:"main"},w={class:"card"},k={class:"field mt-3"},B=p(()=>o("label",{for:"title"},"Title",-1)),N={class:"p-float-label"},V={key:0,class:"p-error"},A={class:"field"},z=p(()=>o("label",{for:"content"},"Content",-1)),U={class:"p-float-label"};function E(e,t,F,M,s,l){const c=n("pv-button"),u=n("pv-tool-bar"),r=n("pv-input-text"),_=n("pv-dialog");return d(),h("div",D,[o("div",w,[i(u,{class:"mb-4"},{start:a(()=>[i(c,{label:"Write review",class:"p-button-error mr-2",onClick:l.openNew},null,8,["onClick"])]),_:1}),i(_,{visible:s.commentDialog,"onUpdate:visible":t[2]||(t[2]=m=>s.commentDialog=m),style:{width:"450px"},header:"New Review",modal:!0,class:"p-fluid"},{footer:a(()=>[i(c,{label:"Cancel".toUpperCase(),icon:"pi pi-times",class:"p-button-text",onClick:l.hideDialog},null,8,["label","onClick"]),i(c,{label:"Save".toUpperCase(),icon:"pi pi-check",class:"p-button-text",onClick:l.saveComment},null,8,["label","onClick"])]),default:a(()=>[o("div",k,[B,o("span",N,[i(r,{class:I(["p-inputtext-sm",{"p-invalid":s.submitted&&!s.comment.title}]),type:"text",id:"title",modelValue:s.comment.title,"onUpdate:modelValue":t[0]||(t[0]=m=>s.comment.title=m),modelModifiers:{trim:!0},required:"true",autofocus:""},null,8,["modelValue","class"]),s.submitted&&!s.comment.title?(d(),h("small",V,"Title is required")):S("",!0)])]),o("div",A,[z,o("span",U,[i(r,{class:"p-inputtext-lg",type:"textarea",id:"description",modelValue:s.comment.content,"onUpdate:modelValue":t[1]||(t[1]=m=>s.comment.content=m),required:"false",rows:"2",cols:"20"},null,8,["modelValue"])])])]),_:1},8,["visible"])])])}var O=v(y,[["render",E],["__scopeId","data-v-1895551c"]]);export{O as default};
