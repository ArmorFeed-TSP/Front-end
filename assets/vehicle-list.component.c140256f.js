var S=Object.defineProperty;var b=Object.getOwnPropertySymbols;var I=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var g=(l,e,n)=>e in l?S(l,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):l[e]=n,y=(l,e)=>{for(var n in e||(e={}))I.call(e,n)&&g(l,n,e[n]);if(b)for(var n of b(e))P.call(e,n)&&g(l,n,e[n]);return l};import{h as m,_ as U,F as N,r,o as d,c as h,a as s,b as i,w as c,n as L,d as v,t as B,j as V}from"./index.06d337ed.js";class M{getAll(){return m.get("/vehicles")}create(e){return m.post("/vehicles",e)}update(e,n){return m.put(`/vehicles/${e}`,n)}delete(e){return m.delete(`/vehicles/${e}`)}getById(e){return m.get(`/vehicles/${e}`)}getVehiclesByEnterpriseId(e){return m.get(`/enterprise/${e}/vehicles`)}}const q={name:"vehicle-list",components:{},props:{enterpriseId:Number},data(){return{vehicles:[],vehicleDialog:!1,deleteVehicleDialog:!1,deleteVehiclesDialog:!1,vehicle:{},selectedVehicles:null,filters:{},submitted:!1,vehiclesService:null,selectedType:null,userId:null,types:[{type:"In use",code:"In use"},{type:"Free",code:"Free"}]}},created(){const l=JSON.parse(localStorage.getItem("auth"));l&&(this.userId=l.id),console.log(this.userId),this.vehiclesService=new M,this.vehiclesService.getVehiclesByEnterpriseId(this.userId).then(e=>{this.vehicles=e.data,this.vehicles.forEach(n=>this.getDisplayableVehicle(n)),console.log("created")}),this.initFilters()},methods:{getDisplayableVehicle(l){return this.vehicle.id=l.id,l},getStorableVehicle(l){return{id:l.id,brand:l.brand,licensePlate:l.licensePlate,year:l.year,model:l.model,maintenanceDate:l.maintenanceDate,vehicleType:l.vehicleType,enterpriseId:l.enterpriseId}},openNew(){this.vehicle={},this.submitted=!1,this.vehicleDialog=!0},hideDialog(){this.vehicleDialog=!1,this.submitted=!1},findIndexById(l){return this.vehicles.findIndex(e=>e.id===l)},saveVehicle(){this.submitted=!0,this.vehicle.brand.trim()&&(this.vehicle.id?(this.vehicle=this.getStorableVehicle(this.vehicle),this.vehiclesService.update(this.vehicle.id,this.vehicle).then(l=>{this.vehicles[this.findIndexById(l.data.id)]=this.getDisplayableVehicle(l.data),this.$toast.add({severity:"success",summary:"Successful",detail:"vehicle Updated",life:3e3}),console.log(l)})):(this.vehicle.id=0,this.vehicle.enterpriseId=this.userId,console.log(this.vehicle),this.vehicle=this.getStorableVehicle(this.vehicle),this.vehiclesService.create(this.vehicle).then(l=>{this.vehicle=this.getDisplayableVehicle(l.data),this.vehicles.push(this.vehicle),this.$toast.add({severity:"success",summary:"Successful",detail:"vehicle Created",life:3e3}),console.log(l)})),this.vehicleDialog=!1,this.vehicle={})},editVehicle(l){console.log(l),this.vehicle=y({},l),console.log(this.vehicle),this.vehicleDialog=!0},confirmDeleteVehicle(l){this.vehicle=l,this.deleteVehicleDialog=!0},deleteVehicle(){this.vehiclesService.delete(this.vehicle.id).then(l=>{this.vehicles=this.vehicles.filter(e=>e.id!==this.vehicle.id),this.deleteVehicleDialog=!1,this.vehicle={},this.$toast.add({severity:"success",summary:"Successful",detail:"vehicle Deleted",life:3e3}),console.log(l)})},deleteSelectedVehicles(){this.selectedVehicles.forEach(l=>{this.vehiclesService.delete(l.id).then(e=>{this.vehicles=this.vehicles.filter(n=>n.id!==this.vehicle.id),console.log(e)})}),this.deleteVehiclesDialog=!1},initFilters(){this.filters={global:{value:null,matchMode:N.CONTAINS}}}}},T={class:"container"},F={class:"flex flex-column space-between align-items-center"},A={class:"my-7 flex flex-column",style:{"max-width":"65rem",width:"100%",margin:"0 auto","min-height":"90vh"}},E={class:"table-header flex flex-column md:flex-row md:justify-content-between"},Y=s("h5",{class:"mb-2 md:m-0 p-as-md-center text-xl"}," Manage vehicles ",-1),R={class:"p-input-icon-left"},z=s("i",{class:"pi pi-search"},null,-1),O={class:"field mt-3"},j={class:"p-float-label"},J=s("label",{for:"brand"},"Brand",-1),G={key:0,class:"p-error"},H={class:"field"},K={class:"p-float-label"},Q=s("label",{for:"licensePlate"},"License Plate",-1),W={key:0,class:"p-error"},X={class:"field"},Z={class:"p-float-label"},$=s("label",{for:"year"},"Year",-1),ee={key:0,class:"p-error"},le={class:"field"},te={class:"p-float-label"},ie=s("label",{for:"model"},"Model",-1),se={key:0,class:"p-error"},oe={class:"field"},ne={class:"p-float-label"},ce=s("label",{for:"maintenanceDate"},"Maintenance Date",-1),ae={key:0,class:"p-error"},re={class:"field"},de={class:"confirmation-content"},he=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),ue={key:0},pe=V("Are you sure you want to delete "),ve=V("?"),me={class:"confirmation-content"},fe=s("i",{class:"pi pi-exclamation-triangle mr-3",style:{"font-size":"2rem"}},null,-1),_e={key:0};function be(l,e,n,ge,t,u){const a=r("pv-button"),x=r("pv-tool-bar"),f=r("pv-input-text"),p=r("pv-column"),D=r("pv-calendar"),w=r("pv-dropdown"),_=r("pv-dialog"),k=r("pv-data-table");return d(),h("div",T,[s("div",F,[s("div",A,[i(x,{class:"toolbarButton mb-4"},{start:c(()=>[i(a,{label:"New",icon:"pi pi-plus",class:"p-button-error mr-2",onClick:u.openNew},null,8,["onClick"])]),_:1}),i(k,{style:{"max-width":"90rem"},ref:"dt",value:t.vehicles,selection:t.selectedVehicles,"onUpdate:selection":e[12]||(e[12]=o=>t.selectedVehicles=o),datakey:"id",paginator:!0,rows:10,filters:t.filters,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport RowsPerPageDropdown",rowsPerPageOptions:[5,10,15],currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} vehicles",responsiveLayout:"scroll"},{header:c(()=>[s("div",E,[Y,s("span",R,[z,i(f,{modelValue:t.filters.global.value,"onUpdate:modelValue":e[0]||(e[0]=o=>t.filters.global.value=o),placeholder:"Search..."},null,8,["modelValue"])])])]),default:c(()=>[i(p,{field:"brand",header:"Brand",sortable:!0,style:{"min-width":"16rem"}}),i(p,{field:"licensePlate",header:"License Plate",sortable:!0,style:{"min-width":"16rem"}}),i(p,{field:"year",header:"Year",sortable:!0,style:{"min-width":"16rem"}}),i(p,{field:"model",header:"Model",sortable:!0,style:{"min-width":"16rem"}}),i(p,{field:"maintenanceDate",header:"Maintenance Date",sortable:!0,style:{"min-width":"16rem"}}),i(p,{field:"vehicleType",header:"Vehicle Status",sortable:!0,style:{"min-width":"16rem"}}),i(p,{exportable:!1,style:{"min-width":"8rem"}},{body:c(o=>[i(a,{icon:"pi pi-pencil",class:"p-button-text p-button-rounded",onClick:C=>u.editVehicle(o.data)},null,8,["onClick"]),i(a,{icon:"pi pi-trash",class:"p-button-text p-button-rounded",onClick:C=>u.confirmDeleteVehicle(o.data)},null,8,["onClick"])]),_:1}),i(_,{visible:t.vehicleDialog,"onUpdate:visible":e[7]||(e[7]=o=>t.vehicleDialog=o),style:{width:"450px"},header:"vehicle Information",modal:!0,class:"p-fluid"},{footer:c(()=>[i(a,{label:"Cancel".toUpperCase(),icon:"pi pi-times",class:"p-button-text",onClick:u.hideDialog},null,8,["label","onClick"]),i(a,{label:"Save".toUpperCase(),icon:"pi pi-check",class:"p-button-text",onClick:u.saveVehicle},null,8,["label","onClick"])]),default:c(()=>[s("div",O,[s("span",j,[i(f,{type:"text",id:"brand",modelValue:t.vehicle.brand,"onUpdate:modelValue":e[1]||(e[1]=o=>t.vehicle.brand=o),modelModifiers:{trim:!0},required:"true",autofocus:"",class:L({"p-invalid":t.submitted&&!t.vehicle.title})},null,8,["modelValue","class"]),J,t.submitted&&!t.vehicle.brand?(d(),h("small",G,"Brand is required")):v("",!0)])]),s("div",H,[s("span",K,[i(f,{type:"text",id:"licensePlate",modelValue:t.vehicle.licensePlate,"onUpdate:modelValue":e[2]||(e[2]=o=>t.vehicle.licensePlate=o),required:"false",rows:"2",cols:"20"},null,8,["modelValue"]),Q,t.submitted&&!t.vehicle.licensePlate?(d(),h("small",W,"License Plate is required")):v("",!0)])]),s("div",X,[s("span",Z,[i(f,{type:"number",id:"year",modelValue:t.vehicle.year,"onUpdate:modelValue":e[3]||(e[3]=o=>t.vehicle.year=o),required:"false",rows:"2",cols:"20"},null,8,["modelValue"]),$,t.submitted&&!t.vehicle.year?(d(),h("small",ee,"Year is required")):v("",!0)])]),s("div",le,[s("span",te,[i(f,{type:"textarea",id:"model",modelValue:t.vehicle.model,"onUpdate:modelValue":e[4]||(e[4]=o=>t.vehicle.model=o),required:"false",rows:"2",cols:"20"},null,8,["modelValue"]),ie,t.submitted&&!t.vehicle.model?(d(),h("small",se,"Model is required")):v("",!0)])]),s("div",oe,[s("span",ne,[i(D,{id:"maintenanceDate",dateFormat:"dd.mm.yy",modelValue:t.vehicle.maintenanceDate,"onUpdate:modelValue":e[5]||(e[5]=o=>t.vehicle.maintenanceDate=o),required:"false",rows:"2",cols:"20"},null,8,["modelValue"]),ce,t.submitted&&!t.vehicle.maintenanceDate?(d(),h("small",ae,"Maintenance Date is required")):v("",!0)])]),s("div",re,[i(w,{modelValue:t.vehicle.vehicleType,"onUpdate:modelValue":e[6]||(e[6]=o=>t.vehicle.vehicleType=o),options:t.types,optionLabel:"type",optionValue:"code",placeholder:"Vehicle Status"},null,8,["modelValue","options"])])]),_:1},8,["visible"]),i(_,{visible:t.deleteVehicleDialog,"onUpdate:visible":e[9]||(e[9]=o=>t.deleteVehicleDialog=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:c(()=>[i(a,{label:"No".toUpperCase(),icon:"pi pi-times",class:"p-button-text",onClick:e[8]||(e[8]=o=>t.deleteVehicleDialog=!1)},null,8,["label"]),i(a,{label:"Yes".toUpperCase(),icon:"pi pi-check",class:"p-button-text",onClick:u.deleteVehicle},null,8,["label","onClick"])]),default:c(()=>[s("div",de,[he,t.vehicle?(d(),h("span",ue,[pe,s("b",null,B(t.vehicle.title),1),ve])):v("",!0)])]),_:1},8,["visible"]),i(_,{visible:t.deleteVehiclesDialog,"onUpdate:visible":e[11]||(e[11]=o=>t.deleteVehiclesDialog=o),style:{width:"450px"},header:"Confirm",modal:!0},{footer:c(()=>[i(a,{label:"No".toUpperCase(),icon:"pi pi-times",class:"p-button-text",onClick:e[10]||(e[10]=o=>t.deleteVehiclesDialog=!1)},null,8,["label"]),i(a,{label:"Yes".toUpperCase(),icon:"pi pi-check",class:"p-button-text",onClick:u.deleteSelectedVehicles},null,8,["label","onClick"])]),default:c(()=>[s("div",me,[fe,t.vehicle?(d(),h("span",_e,"Are you sure you want to delete the selected vehicles?")):v("",!0)])]),_:1},8,["visible"])]),_:1},8,["value","selection","filters"])])])])}var xe=U(q,[["render",be]]);export{xe as default};
